---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Tags from '../../components/Tags.astro';

const pageTitle = 'My astro learning blog.';

import PageInfo from '../../components/PageInfo.astro';
import BlogPost from '../../components/BlogPost.astro';
import Pagination from '../../components/Pagination.astro';

export async function getStaticPaths({ paginate }) {
  const allPosts = await Astro.glob('./*.md');
  const filteredPosts = allPosts.sort((a, b) => {
    return (
      new Date(b.frontmatter.pubDate).valueOf() -
      new Date(a.frontmatter.pubDate).valueOf()
    );
  });
  // Generate pages from our array of astronauts, with 2 to a page
  return paginate(filteredPosts, { pageSize: 5 });
}
// All paginated data is passed on the "page" prop
const { page } = Astro.props;
---

<BaseLayout pageTitle={pageTitle}>
  <PageInfo
    pageTitle="Welcome to My Blog ðŸ‘‹"
    pageDesc="Thank you for visiting my blog! Here, I'll be sharing my experiences, insights, and thoughts on various topics."
  />
  <div id="blog-posts">
    <div class="posts glass">
      {
        page.data.map((post) => (
          <BlogPost url={post.url} {...post.frontmatter} />
        ))
      }
    </div>
    <Tags />
    <Pagination prev={page.url.prev} next={page.url.next} />
  </div>
</BaseLayout>

<style lang="scss">
  #blog-posts {
    margin-top: 3rem;
    display: grid;
    align-items: start;
    grid-template-columns: 1fr;
    gap: 3rem;
    row-gap: 1rem;

    .posts {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      border-radius: 8px;
      padding: 1rem;
    }

    @media screen and (min-width: 636px) {
      grid-template-columns: 1fr 30%;
    }
  }
</style>
